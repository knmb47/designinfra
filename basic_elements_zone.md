# 基本要素 02. ゾーン

ゾーンはアーキテクチャ設計のなかで、最も理解しづらい概念だと思います。ひとまず頑張りましょう。
まず、非機能要件の必要性を理解することが重要です。
非機能要件を定義し程度を定義することでゾーンは生まれます。そして、ゾーンは、ノードがひとつではあまり用をなさず、ノードが複数あることで重要性を増します。

サンプルに使っている図で、意味もなくゾーンを分けています。

![基本要素を含んだダイアグラム](basic_elements_diagram.drawio.svg)

この絵は、何の要件もなく、設計図っぽいものを書いただけですので実はゾーンに意味合いは有りません。非機能要件が存在しなければ、これらの線は無意味だということです。
では、どのようにゾーンを分けるのでしょう。

## ゾーンの分け方

ゾーンを分けることは、非機能要件を定義し程度を定義することです。

非機能要件として、境界型セキュリティ防御の考え方でシステムを守る設計を行っているとしましょう。ネットワークの論理的な話になると分かりにくくなるので、物理的な例で考えましょう。
手っ取り早く考えたいのでデータの価値とかを考えずに守る対象のシステム自体に高い価値（希少金属が沢山使われている的な）があり、盗まれてはいけないとします。

防御する設計を考えて下さい。私ならば金庫に入れ何重もの隔壁を設けます。しかも、普通なら手に届かないような空間に置きます。例えば、宇宙ステーション、例えば、某国の官邸とか。

多分、一般の路上から某国の官邸の地下室まで、物理セキュリティの確保できる程度の「分類」を想像されたのではないでしょうか。
思いつく限りでセキュリティの低そうな順番で書き下してみます。

- 政府の治安機関が機能していない国の路上
- 日本の一般の路上
- 普通のマンション程度の屋内
- 一般家庭の室内
- 銀行の金庫室
- 国際宇宙ステーション
- 某国の官邸某国の官邸の非常事態用の地下シェルター

これはゾーンでしょうか。違いますね。概念レベルでの物理ロケーションになります。幾つか例を上げたのですから、ここから帰納的にゾーン定義に昇格させることができそうです。
また、もう一つの観点として、使わなければ価値を産まないコンピュータシステムです。使用できる必要があります。それぞれのロケーションにはどんな制約が存在するのか考えることになります。

ゾーンになりそうな候補を分析すると
- 「路上」と「屋内」と「屋内の更に守られた場所」と「金庫の中」
- 「宇宙空間」と「治安期間の機能している国の領域」と「治安期間の機能していない国の領域」
- 「一般家庭」「共同住宅」「会社組織」「公的組織」「国際組織」

ここまで抽象化すると、物理的防御の非機能要件の程度が分類できてきました。

最初の例を見ると良くある物理セキュリティゾーン定義に近くなってきましたね。
「金庫の中」は、金庫が小さいと、制約上では使いづらいので除外ですが、SFなんかで特殊な機器が配置されている部屋とかが有りそうです。

以下のようなゾーン分類にすると、どの種のコンピュータ・デバイスをどこに配置して良いことにするか定まってきます。。
- 「屋外」　：　スマホやノートPC
- 「屋内」　：　OAパソコン
- 「屋内の更に守られた場所」　：　サーバ
- 「屋内で極度にロックされた場所」　：　超大事なサーバ

物理的な例で記述したので、この様な設計の場合は、ゾーンが建築物の設計図と一致してきます。次に出てくるのは、「ゾーンの境界をどう置くか」です。
「屋外」と「屋内で極度にロックされた場所」を薄い壁一枚で隔てて、窓ガラスなんか付けたりはしないですよね。ナイトライダー２０００が壁を突き破って突っ込んできて、一気に機械を持っていかれてしまいます。
それぞれの「ゾーン」の間には、それなりの「壁」を用意します。一般的には、程度の段階が違うゾーンとの間には、境界すら存在しないようにします。


図の上でゾーンはノードを入れる大きな枠として記述します。ゾーンは非機能要件の程度を意味し、ゾーンの枠は非機能要件の境界を意味します。非機能要件の分かりやすい例えは、トラディショナルなセキュリティ確保水準での分類です。セキュリティという非機能要件では、「制御不能ゾーン」>「制御ゾーン」>「制限ゾーン」>「安全ゾーン」>「保護ゾーン」などでデータ保存時のセキュリティ確保水準を分けるかもしれません。

設計の過程で、これから作るシステムのアーキテクチャを形作るにあたり、設計図の枠に物理的な建物や部屋を書いてから始めるのはお奨めできません。それらは別で説明するロケーションで考慮します。システムが満たそうとする非機能要件を整理し、確保する単位で決定を行っていく必要がありますので、まずはゾーンから始めることになります。

クラウドサービスで出てくる「アベイラビリティゾーン」は、「データセンター」を超えて「可用性（アベイラビリティ）」の担保を目標とする機能を備えたゾーンということです。AWSのページを見ていると、昨今のコンピューティングの利用ニーズに合わせて、「Wavelength」「ローカルゾーン」というデバイスとの通信レイテンシに着目したゾーン定義も増えているようですね。

非機能要件として、セキュリティと可用性のゾーンを紹介しました。同じシステムを別の非機能の尺度でみる場合、ゾーンの区分けも異なり、見た目が違う（ビューが違う）結果になります。

